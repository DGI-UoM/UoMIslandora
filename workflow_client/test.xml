<workflow xmlns="http://www.islandora.ca" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.islandora.ca http://localhost/workflow.xsd">
  
  <!-- Generates thumbnail. Initialized as completed since the 
  thumbnail has already been generated by an ingest rule.-->
  <process id="thumbnail" name="image_resize" state="completed">
    <dependant>FULL_SIZE</dependant>
    <parameters>
      <parameter name="dsid">FULL_SIZE</parameter>
      <parameter name="width">150</parameter>
      <parameter name="file_ext">jpg</parameter>
    </parameters>
  </process>
  
  <!-- Generates a "medium" sized JPG image to display. -->
  <process id="medium" name="image_resize" state="waiting">
    <dependant>FULL_SIZE</dependant>
    <parameters>
      <parameter name="dsid">FULL_SIZE</parameter>
      <parameter name="dest_ds">JPG</parameter>
      <parameter name="width">800</parameter>
      <parameter name="file_ext">jpg</parameter>
    </parameters>
  </process>
  
  <!-- Generates a jpeg2000 image that can be viewed through the Djatoka image server -->
  <process id="jp2" name="create_jp2" state="waiting">
    <dependant>FULL_SIZE</dependant>
    <parameters>
      <parameter name="dsid">FULL_SIZE</parameter>
    </parameters>
  </process>
  
  <!-- Analyzes the original image and extracts technical 
  metadata that gets stored in its own datastream -->
  <process id="jhove" name="jhove" state="waiting">
    <dependant>FULL_SIZE</dependant>
    <parameters>
      <parameter name="dsid">FULL_SIZE</parameter>
      <parameter name="dest_ds">ANSI</parameter>
    </parameters>
  </process>
  
  <!-- Updates the MODS datastream with relatedItems relationships, 
  items, and other administrative metadata that fedora knows about already -->
  <process id="mods" name="mods_extend" state="waiting">
    <dependant>MODS</dependant>.
    <parameters>
      <parameter name="dsid">MODS</parameter>
    </parameters>
  </process>
  
  <!-- Runs an XSLT on the MODS datastream to generate a new dublin core that 
  is used by fedora -->
  <process id="dc" name="xslt" state="waiting">
    <dependant>MODS</dependant>
    <prereq>mods</prereq>
    <parameters>
      <parameter name="dsid">MODS</parameter>
      <parameter name="xslt">uofm:highResImage/MODS_TO_DC</parameter>
    </parameters>
  </process>
  
  <!-- Indexes the MODS datastream by running it through an XSLT and 
  submitting it to solr. Wont execute until mods_extend has been run -->
  <process id="solr" name="solr_index" state="waiting">
    <dependant>MODS</dependant>
    <prereq>mods</prereq>
    <parameters>
      <parameter name="dsid">MODS</parameter>
      <parameter name="xslt">uofm:highResImage/MODS_TO_SOLR</parameter>
    </parameters>
  </process>
  
</workflow>
